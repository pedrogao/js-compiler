# JavaScript Compiler in Rust

> All codes(include README) are generated by Github copilot.

A modern JavaScript compiler written in Rust that supports multiple target architectures and includes a built-in VM for debugging and development.

## Features

### Compilation Targets

- **x64 Assembly**: Native code generation for x86_64 platforms
- **ARM64 Assembly**: Native code generation for ARM64 platforms (Apple Silicon/M1)
- **WebAssembly**: Generate WASM modules for web deployment
- **VM Mode**: Built-in virtual machine for debugging and development

### Language Features

- Functions and recursion
- Control flow (if/else, while)
- Arithmetic and logical operations
- Variables and scoping
- Basic type system (numbers, strings, booleans, null)
- First-class functions
- Built-in `print` function

### Development Features

- Source code debugging
- HTML visualization of execution trace
- Rich error reporting
- Optimization passes
- Stack trace support

## Usage

Building for Different Targets

```sh
# VM Mode (default, no native code generation)
cargo run --no-default-features

# x64 Assembly Generation
cargo run --features x64 --no-default-features

# ARM64 Assembly Generation
cargo run --features arm64 --no-default-features

# WebAssembly Generation
cargo run --features wasm --no-default-features
```

Running JavaScript Code

```sh
# Run example code in VM mode
cargo run

# Compile a JavaScript file
cargo run --features x64 path/to/source.js

# Enable debugging
cargo run path/to/source.js --debug
```

Project Structure

```sh
src/
├── codegen/        # Code generation for different targets
│   ├── x64.rs     # x86_64 assembly generation
│   ├── arm64.rs   # ARM64 assembly generation
│   └── wasm.rs    # WebAssembly generation
├── ir/            # Intermediate representation
├── lexer/         # Lexical analysis
├── parser/        # Syntax parsing
├── optimizer/     # IR optimizations
├── vm/            # Virtual machine implementation
└── debug/         # Debugging support
```

Example

```js
// Input JavaScript
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

function main() {
  let result = fibonacci(10);
  print(result); // Output: 55
  return result;
}
```

Generated outputs:

- VM mode: Direct execution with debugging
- x64/ARM64: Native assembly file (.s)
- WebAssembly: WAT file (.wat)

## Debugging

The compiler includes a built-in debugger that generates an HTML visualization of the program execution:

1. Run in VM mode
2. Open debug_output.html
3. View execution trace, stack state, and variable values

## License

MIT License - See LICENSE for details

## Acknowledgments

- Rust Community
